# Разведочный анализ данных: Fraud Detection

## Обзор

Для решения таска также пользовался Claude Opus 4.5, початился с ним примерно минут 30-40, идеи и гипотезы на которых мы сошлись написал ниже)

Анализ датасета транзакций для выявления мошенничества. Данные содержат информацию о транзакциях, клиентах, устройствах, географии и метку `is_fraud`.

---

## Продуктовые гипотезы (бизнес-ценность)

| # | Гипотеза | Ожидаемая ценность | Метрика успеха |
|---|----------|-------------------|----------------|
| **P1** | Внедрение real-time скоринга на основе `last_hour_activity` снизит fraud rate | Снижение финансовых потерь на 15-30% | Снижение fraud rate при сохранении конверсии |
| **P2** | Транзакции `is_outside_home_country=True` требуют дополнительной верификации (SMS/push) | Сокращение международного фрода | Fraud rate для международных операций |
| **P3** | Клиенты с высокой активностью (`unique_merchants > 95 percentile`) — группа риска, им нужен отдельный UX | Раннее выявление компрометации аккаунта | Время обнаружения мошенничества |
| **P4** | Для `is_high_risk_vendor=True` можно ввести лимиты или задержку выплат | Снижение потерь в рисковых категориях | Сумма предотвращённого фрода |
| **P5** | Ночные транзакции (2-5 утра) в нетипичной географии — триггер для блокировки | Автоматическое предотвращение фрода | False Positive Rate vs Fraud Catch Rate |

---

## Технические гипотезы (ML/Data Science)

| # | Гипотеза | Как проверить | Ожидаемый результат |
|---|----------|---------------|---------------------|
| **T1** | Признаки `last_hour_activity` — самые важные для модели | Feature Importance (SHAP, permutation) | Top-5 features из этой группы |
| **T2** | Комбинация `is_card_present=False` + `is_outside_home_country=True` даёт высокий lift | Построить interaction feature, сравнить AUC | Lift > 2x по сравнению с отдельными признаками |
| **T3** | `device_fingerprint` + `ip_address` позволяют выявлять fraud-кольца | Графовый анализ связей между устройствами | Обнаружение кластеров мошенников |
| **T4** | Velocity features (транзакций/час, сумма/час) важнее абсолютных сумм | Сравнение моделей с/без velocity | Улучшение Precision-Recall AUC на 5%+ |
| **T5** | Аномалии в паттерне `vendor_category` для клиента — сильный сигнал | Построить user-level baseline, считать deviation | Высокая корреляция отклонений с fraud |
| **T6** | Модель на основе LightGBM/CatBoost превзойдёт логистическую регрессию | A/B тест моделей | F1-score improvement > 10% |
| **T7** | Стратификация по `card_type` улучшит качество модели | Отдельные модели или стратифицированное обучение | Улучшение метрик для Premium-карт |

---

## Рекомендуемые следующие шаги

### 1. MVP модели
├── Baseline: Logistic Regression на топ-10 признаках
└── Target: LightGBM с velocity features

text


### 2. Feature Engineering
├── Ratio: amount / lha_max_single_amount
├── Time since last transaction
└── Deviation from customer's typical amount

text


### 3. Инфраструктура
├── Real-time scoring API (latency < 100ms)
└── Feature Store для last_hour_activity

text


### 4. Мониторинг
├── Drift detection по распределению признаков
└── A/B тестирование threshold'ов

text


---

## Структура данных

### Основной датасет: `transaction_fraud_data.parquet`

| Поле | Описание | Тип |
|------|----------|-----|
| `transaction_id` | Уникальный идентификатор транзакции | String |
| `customer_id` | Уникальный идентификатор клиента | String |
| `amount` | Сумма транзакции | Float64 |
| `is_fraud` | Метка мошенничества | Boolean |
| `last_hour_activity` | Активность за последний час | Struct |

### Вспомогательный датасет: `historical_currency_exchange.parquet`

Курсы валют относительно USD за период 2024-09-30 — 2024-10-30.
